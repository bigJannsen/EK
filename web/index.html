<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <title>Einkaufsmanager</title>
    <link rel="stylesheet" href="/static/styles.css">
    <style>
        header.page-header {
            position: relative;
        }

        #datetime {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 0.9rem;
            color: #444;
            background: rgba(255, 255, 255, 0.8);
            padding: 4px 8px;
            border-radius: 6px;
            font-family: monospace;
        }
    </style>
</head>
<body>

<header class="page-header">
    <h1>Einkaufsmanager</h1>
    <p>Verwalte Artikel, Einkaufslisten und Preisvergleiche bequem im Browser.</p>
    <div id="datetime"></div>
</header>

<main class="layout">
    <section class="panel" id="database-panel">
        <h2>Datenbankverwaltung</h2>
        <div class="panel-content">
            <label for="database-select">Datenbankdatei</label>
            <div class="database-select">
                <select id="database-select"></select>
                <button type="button" id="reload-database">Aktualisieren</button>
            </div>
            <div class="table-container">
                <table id="database-table">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Artikel</th>
                        <th>Anbieter</th>
                        <th>Preis (€)</th>
                        <th>Menge</th>
                        <th>Aktionen</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="forms-grid">
                <form id="add-entry-form" class="form-card">
                    <h3>Neuen Eintrag hinzufügen</h3>
                    <label>ID
                        <input type="number" id="add-id" required min="0" step="1">
                    </label>
                    <label>Artikel
                        <input type="text" id="add-artikel" required>
                    </label>
                    <label>Anbieter
                        <input type="text" id="add-anbieter" required>
                    </label>
                    <label>Preis (€)
                        <input type="number" id="add-preis" required min="0" step="0.01">
                    </label>
                    <label>Mengenwert
                        <input type="number" id="add-mengewert" required min="0.01" step="0.01">
                    </label>
                    <label>Einheit
                        <select id="add-mengeeinheit" required>
                            <option value="g">g</option>
                            <option value="kg">kg</option>
                            <option value="l">l</option>
                            <option value="stk">Stk</option>
                        </select>
                    </label>
                    <button type="submit">Eintrag hinzufügen</button>
                </form>
                <form id="edit-entry-form" class="form-card" hidden>
                    <h3>Eintrag bearbeiten</h3>
                    <label>ID
                        <input type="number" id="edit-id" readonly>
                    </label>
                    <label>Artikel
                        <input type="text" id="edit-artikel" required>
                    </label>
                    <label>Anbieter
                        <input type="text" id="edit-anbieter" required>
                    </label>
                    <label>Preis (€)
                        <input type="number" id="edit-preis" required min="0" step="0.01">
                    </label>
                    <label>Mengenwert
                        <input type="number" id="edit-mengewert" required min="0.01" step="0.01">
                    </label>
                    <label>Einheit
                        <select id="edit-mengeeinheit" required>
                            <option value="g">g</option>
                            <option value="kg">kg</option>
                            <option value="l">l</option>
                            <option value="stk">Stk</option>
                        </select>
                    </label>
                    <div class="form-actions">
                        <button type="submit">Änderungen speichern</button>
                        <button type="button" id="cancel-edit">Abbrechen</button>
                    </div>
                </form>
            </div>
        </div>
    </section>
    <section class="panel" id="list-panel">
        <h2>Einkaufsliste</h2>
        <div class="panel-content">
            <div class="table-container">
                <table id="list-table">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>Artikel</th>
                        <th>Anbieter</th>
                        <th>Aktionen</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="forms-grid">
                <form id="add-list-form" class="form-card">
                    <h3>Zur Liste hinzufügen</h3>
                    <label>Artikel
                        <input type="text" id="list-add-artikel" required>
                    </label>
                    <label>Anbieter (optional)
                        <input type="text" id="list-add-anbieter">
                    </label>
                    <button type="submit">Hinzufügen</button>
                </form>
                <form id="edit-list-form" class="form-card" hidden>
                    <h3>Listeneintrag bearbeiten</h3>
                    <input type="hidden" id="list-edit-index">
                    <label>Artikel
                        <input type="text" id="list-edit-artikel" required>
                    </label>
                    <label>Anbieter (optional)
                        <input type="text" id="list-edit-anbieter">
                    </label>
                    <div class="form-actions">
                        <button type="submit">Speichern</button>
                        <button type="button" id="cancel-list-edit">Abbrechen</button>
                    </div>
                </form>
            </div>
        </div>
    </section>
    <section class="panel" id="compare-panel">
        <h2>Preisvergleich</h2>
        <div class="panel-content">
            <div class="compare-grid">
                <form id="single-compare-form" class="form-card">
                    <h3>Einzelvergleich</h3>
                    <label>Erster Artikel
                        <select id="compare-first"></select>
                    </label>
                    <label>Zweiter Artikel
                        <select id="compare-second"></select>
                    </label>
                    <label>Menge (Einheit wie in Artikel)
                        <input type="number" id="compare-amount" required min="0" step="0.01">
                    </label>
                    <button type="submit">Vergleichen</button>
                    <output id="single-compare-result" class="result-box"></output>
                </form>
                <form id="list-compare-form" class="form-card">
                    <h3>Liste optimieren</h3>
                    <label class="checkbox-label">
                        <input type="checkbox" id="apply-best-offers"> Optimale Anbieter in die Liste übernehmen
                    </label>
                    <button type="submit">Analyse starten</button>
                    <div id="list-compare-result" class="result-box"></div>
                </form>
            </div>
        </div>
    </section>
</main>

<footer class="page-footer">
    <p>Server läuft lokal auf <span id="server-address">http://localhost:8080</span></p>
</footer>

<script src="/static/app.js" defer></script>
<script>
    function updateDateTime() {
        const now = new Date();
        const options = { weekday: 'short', day: '2-digit', month: '2-digit', year: 'numeric' };
        const date = now.toLocaleDateString('de-DE', options);
        const time = now.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        document.getElementById('datetime').textContent = `${date} ${time}`;
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();
</script>

</body>
</html>
